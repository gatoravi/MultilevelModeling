library(foreign)
p1 <- read.dta("dat/pollution.dta")
head(p1)
ggplot(t) + geom_point(aes(x = NOX, y = MORT))
require(ggplot2)
ggplot(t) + geom_point(aes(x = NOX, y = MORT))
summary(t)
ggplot(p1) + geom_point(aes(x = NOX, y = MORT))
head(p1)
ggplot(p1) + geom_point(aes(x = nox, y = mort))
ggsave("pollution_scatterplot.png")
m1 <- lm(mort ~ nox, data = p1)
summary(m1)
ggplot(p1) + geom_point(aes(x = nox, y = mort)) 
m1$residuals
plot(m1$fitted.values, m1$residuals)
plot(m1$fitted.values, m1$residuals, title = "Residual plot")
plot(m1$fitted.values, m1$residuals, main = "Residual plot")
png("p1_residuals.png")
plot(m1$fitted.values, m1$residuals, main = "Residual plot - after transformation")
dev.off()
ls()
head(p1)
p1$lognox <- log10(p1$nox)
m2 <- lm(mort ~ lognox, data = p1)
summary(m2)
plot(m2$fitted.values, m2$residuals, main = "Residual plot - after transformation")
ggplot(p1) + geom_point(aes(x = lognox, y = mort)) 
ggplot(p1) + geom_point(aes(x = lognox, y = mort)) + ggtitle("scatterplot after tranformation")
ggsave("pollution_scatterplot2.png")
png("p1_residuals2.png"
)
plot(m2$fitted.values, m2$residuals, main = "Residual plot - after transformation")
dev.off()
summary(m2
)
summary(m1)
summary(m2)
plot(log10(p1$mort), p1$nox)
summary(p1$mort
)
summary(m2)
head(p1)
plot(so2, mort)
plot(p1$so2, p1$mort)
plot(log10(p1$hc, p1$mort)
plot(log10(p1$so2), p1$mort)
plot(p1$so2, p1$mort)
plot(log10(p1$so2), p1$mort)
m2 <- lm(mort ~ lognox + logso2 + loghc, data = p1)
p1$loghc <- log10(hc)
p1$loghc <- log10(p1$hc)
head)p1)
head(p1)
p1$logso2 <- log10(p1$so2)
m2 <- lm(mort ~ lognox + logso2 + hc, data = p1)
plot(
m3 <- lm(mort ~ lognox + so2 + loghc, data = p1)
summary(m3)
plot(log10(p1$hc), p1$mort)
m4 <- lm(mort ~ lognox + logso2 + hc, data = p1)
summary(m4)
m4 <- lm(mort ~ logso2 + hc, data = p1)
summary(m4)
plot(log10(p1$hc), p1$mort)
plot(sqrt(p1$hc), p1$mort)
plot(loghc, m3$mort)
plot(p1$loghc, p1$mort)
beta.hat <- coef (m3)
curve (cbind (1, mean(lognox), logso2, mean(loghc)) %*% beta.hat, col="black", add=TRUE)
attach(p1)
curve (cbind (1, mean(lognox), logso2, mean(loghc)) %*% beta.hat, col="black", add=TRUE)
beta.hat
m3 <- lm(mort ~ lognox + logso2 + loghc, data = p1)
curve (cbind (1, mean(lognox), logso2, mean(loghc)) %*% beta.hat, col="black", add=TRUE)
curve (cbind (1, mean(lognox), logso2, mean(loghc)) %*% beta.hat, col="black", add=TRUE)
beta.hat
nrow(p1)
p1_first30 <- p1[1:30, ]
p1_last30 <- p1[31:60, ]
nrow(p1_last30)
m3 <- lm(mort ~ lognox + logso2 + loghc, data = p1_first30)
summary(m3)
predict(m3, p1_last30)
plot(p1_last30$mort, predict(m3, p1_last30))
plot(p1_last30$mort, predict(m3, p1_last30), xlab = "observed", ylab = "predicted")
plot(p1_last30$mort, predict(m3, p1_last30), xlab = "observed", ylab = "predicted", main = "test")
plot(p1_last30$mort, predict(m3, p1_last30), xlab = "observed", ylab = "predicted", main = "Model-fitting")
png("p1_modelfit.png")
plot(p1_last30$mort, predict(m3, p1_last30), xlab = "observed", ylab = "predicted", main = "Model-fitting")
dev.off()
cor(p1_last30$mort, predict(m3, p1_last30))
cor(p1_last30$mort, predict(m3, p1_last30), method="spearman")
